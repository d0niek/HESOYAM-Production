<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>HESOYAM Production: AnimationPipeline.AnimationProcessor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">HESOYAM Production
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classAnimationPipeline_1_1AnimationProcessor.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Properties</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classAnimationPipeline_1_1AnimationProcessor-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">AnimationPipeline.AnimationProcessor Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class extends the standard ModelProcessor to include code that extracts a skeleton, pulls any animations, and does any necessary prep work to support animation and skinning.  
 <a href="classAnimationPipeline_1_1AnimationProcessor.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for AnimationPipeline.AnimationProcessor:</div>
<div class="dyncontent">
<div class="center"><img src="classAnimationPipeline_1_1AnimationProcessor__inherit__graph.png" border="0" usemap="#AnimationPipeline_8AnimationProcessor_inherit__map" alt="Inheritance graph"/></div>
<map name="AnimationPipeline_8AnimationProcessor_inherit__map" id="AnimationPipeline_8AnimationProcessor_inherit__map">
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for AnimationPipeline.AnimationProcessor:</div>
<div class="dyncontent">
<div class="center"><img src="classAnimationPipeline_1_1AnimationProcessor__coll__graph.png" border="0" usemap="#AnimationPipeline_8AnimationProcessor_coll__map" alt="Collaboration graph"/></div>
<map name="AnimationPipeline_8AnimationProcessor_coll__map" id="AnimationPipeline_8AnimationProcessor_coll__map">
<area shape="rect" id="node3" href="classApp_1_1Animation_1_1ModelExtra.html" title="Class that contains additional information attached to the model and shared with the runtime..." alt="" coords="152,5,331,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9879bef634fdeef10473d3a6b6026e1e"><td class="memItemLeft" align="right" valign="top">override ModelContent&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a9879bef634fdeef10473d3a6b6026e1e">Process</a> (NodeContent input, ContentProcessorContext context)</td></tr>
<tr class="memdesc:a9879bef634fdeef10473d3a6b6026e1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function to process a model from original content into model content for export  <a href="#a9879bef634fdeef10473d3a6b6026e1e">More...</a><br/></td></tr>
<tr class="separator:a9879bef634fdeef10473d3a6b6026e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a3e94f6b4306da38c809b03182e3a8c2a"><td class="memItemLeft" align="right" valign="top">BoneContent&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a3e94f6b4306da38c809b03182e3a8c2a">ProcessSkeleton</a> (NodeContent input)</td></tr>
<tr class="memdesc:a3e94f6b4306da38c809b03182e3a8c2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the skeleton in support of skeletal animation...  <a href="#a3e94f6b4306da38c809b03182e3a8c2a">More...</a><br/></td></tr>
<tr class="separator:a3e94f6b4306da38c809b03182e3a8c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8132ed58af8d326eb1210fd06de97a4c"><td class="memItemLeft" align="right" valign="top">List&lt; NodeContent &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a8132ed58af8d326eb1210fd06de97a4c">FlattenHeirarchy</a> (NodeContent item)</td></tr>
<tr class="memdesc:a8132ed58af8d326eb1210fd06de97a4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a tree of nodes into a list of nodes in topological order.  <a href="#a8132ed58af8d326eb1210fd06de97a4c">More...</a><br/></td></tr>
<tr class="separator:a8132ed58af8d326eb1210fd06de97a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41139de03a4f92ccad238418a4219556"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a41139de03a4f92ccad238418a4219556">FlattenHeirarchy</a> (List&lt; NodeContent &gt; nodes, NodeContent item)</td></tr>
<tr class="separator:a41139de03a4f92ccad238418a4219556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ca18c0cd82c0f3adca2f2bfecf7039c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a3ca18c0cd82c0f3adca2f2bfecf7039c">FlattenTransforms</a> (NodeContent node, BoneContent skeleton)</td></tr>
<tr class="memdesc:a3ca18c0cd82c0f3adca2f2bfecf7039c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bakes unwanted transforms into the model geometry, so everything ends up in the same coordinate system.  <a href="#a3ca18c0cd82c0f3adca2f2bfecf7039c">More...</a><br/></td></tr>
<tr class="separator:a3ca18c0cd82c0f3adca2f2bfecf7039c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea72ffe7e084414e5508f84dd5a08adf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#aea72ffe7e084414e5508f84dd5a08adf">FlattenAllTransforms</a> (NodeContent node)</td></tr>
<tr class="memdesc:aea72ffe7e084414e5508f84dd5a08adf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recursively flatten all transforms from this node down  <a href="#aea72ffe7e084414e5508f84dd5a08adf">More...</a><br/></td></tr>
<tr class="separator:aea72ffe7e084414e5508f84dd5a08adf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55100caa7f922c28e5049fd9120ed014"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a55100caa7f922c28e5049fd9120ed014">TrimSkeleton</a> (NodeContent skeleton)</td></tr>
<tr class="memdesc:a55100caa7f922c28e5049fd9120ed014"><td class="mdescLeft">&#160;</td><td class="mdescRight">3D Studio Max includes an extra help bone at the end of each IK chain that doesn't effect the skinning system and is redundant as far as any game is concerned. This function looks for children who's name ends with "Nub" and removes them from the heirarchy.  <a href="#a55100caa7f922c28e5049fd9120ed014">More...</a><br/></td></tr>
<tr class="separator:a55100caa7f922c28e5049fd9120ed014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43e73c1eddf091312c6bad639d248560"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a43e73c1eddf091312c6bad639d248560">IsSkinned</a> (NodeContent node)</td></tr>
<tr class="memdesc:a43e73c1eddf091312c6bad639d248560"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if a node is a skinned node, meaning it has bone weights associated with it.  <a href="#a43e73c1eddf091312c6bad639d248560">More...</a><br/></td></tr>
<tr class="separator:a43e73c1eddf091312c6bad639d248560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fec0ea7cab5a0295dd94b14e4ade3df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a1fec0ea7cab5a0295dd94b14e4ade3df">SwapSkinnedMaterial</a> (NodeContent node)</td></tr>
<tr class="memdesc:a1fec0ea7cab5a0295dd94b14e4ade3df"><td class="mdescLeft">&#160;</td><td class="mdescRight">If a node is skinned, we need to use the skinned model effect rather than basic effect. This function runs through the geometry and finds the meshes that have bone weights associated and swaps in the skinned effect.  <a href="#a1fec0ea7cab5a0295dd94b14e4ade3df">More...</a><br/></td></tr>
<tr class="separator:a1fec0ea7cab5a0295dd94b14e4ade3df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ced5d1d24f6961601cf4c955ac10236"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a4ced5d1d24f6961601cf4c955ac10236">ProcessAnimations</a> (ModelContent <a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#ab06ca8642aa12e3b13dbfd1637d27334">model</a>, NodeContent input, ContentProcessorContext context)</td></tr>
<tr class="memdesc:a4ced5d1d24f6961601cf4c955ac10236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry point for animation processing.  <a href="#a4ced5d1d24f6961601cf4c955ac10236">More...</a><br/></td></tr>
<tr class="separator:a4ced5d1d24f6961601cf4c955ac10236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a723969e331d9421805e95d04418aedc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a723969e331d9421805e95d04418aedc7">ProcessAnimationsRecursive</a> (NodeContent input)</td></tr>
<tr class="memdesc:a723969e331d9421805e95d04418aedc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recursive function that processes the entire scene graph, collecting up all of the animation data.  <a href="#a723969e331d9421805e95d04418aedc7">More...</a><br/></td></tr>
<tr class="separator:a723969e331d9421805e95d04418aedc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a542aae0ce95a939066d58a1236af36ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a542aae0ce95a939066d58a1236af36ec">LinearKeyframeReduction</a> (LinkedList&lt; <a class="el" href="classApp_1_1Animation_1_1AnimationClip_1_1Keyframe.html">AnimationClip.Keyframe</a> &gt; keyframes)</td></tr>
<tr class="memdesc:a542aae0ce95a939066d58a1236af36ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function filters out keyframes that can be approximated well with linear interpolation.  <a href="#a542aae0ce95a939066d58a1236af36ec">More...</a><br/></td></tr>
<tr class="separator:a542aae0ce95a939066d58a1236af36ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ce537df1bc9f23d2b948a423c77d45c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a5ce537df1bc9f23d2b948a423c77d45c">UselessAnimationTest</a> (int boneId)</td></tr>
<tr class="memdesc:a5ce537df1bc9f23d2b948a423c77d45c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discard any animation not assigned to a mesh or the skeleton  <a href="#a5ce537df1bc9f23d2b948a423c77d45c">More...</a><br/></td></tr>
<tr class="separator:a5ce537df1bc9f23d2b948a423c77d45c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab06ca8642aa12e3b13dbfd1637d27334"><td class="memItemLeft" align="right" valign="top">ModelContent&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#ab06ca8642aa12e3b13dbfd1637d27334">model</a></td></tr>
<tr class="memdesc:ab06ca8642aa12e3b13dbfd1637d27334"><td class="mdescLeft">&#160;</td><td class="mdescRight">The model we are reading  <a href="#ab06ca8642aa12e3b13dbfd1637d27334">More...</a><br/></td></tr>
<tr class="separator:ab06ca8642aa12e3b13dbfd1637d27334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7fd1f423cb71f1865f5e7cab97df94a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classApp_1_1Animation_1_1ModelExtra.html">ModelExtra</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#ac7fd1f423cb71f1865f5e7cab97df94a">modelExtra</a> = new <a class="el" href="classApp_1_1Animation_1_1ModelExtra.html">ModelExtra</a>()</td></tr>
<tr class="memdesc:ac7fd1f423cb71f1865f5e7cab97df94a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extra content to associated with the model. This is where we put the stuff that is unique to this project.  <a href="#ac7fd1f423cb71f1865f5e7cab97df94a">More...</a><br/></td></tr>
<tr class="separator:ac7fd1f423cb71f1865f5e7cab97df94a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43cd4a67fcf9369003f4bf58212a2081"><td class="memItemLeft" align="right" valign="top">Dictionary&lt; MaterialContent, <br class="typebreak"/>
SkinnedMaterialContent &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a43cd4a67fcf9369003f4bf58212a2081">toSkinnedMaterial</a> = new Dictionary&lt;MaterialContent, SkinnedMaterialContent&gt;()</td></tr>
<tr class="memdesc:a43cd4a67fcf9369003f4bf58212a2081"><td class="mdescLeft">&#160;</td><td class="mdescRight">A lookup dictionary that remembers when we changes a material to skinned material.  <a href="#a43cd4a67fcf9369003f4bf58212a2081">More...</a><br/></td></tr>
<tr class="separator:a43cd4a67fcf9369003f4bf58212a2081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e49c12d26657eeb0837340c1f0c5d75"><td class="memItemLeft" align="right" valign="top">Dictionary&lt; string, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a7e49c12d26657eeb0837340c1f0c5d75">bones</a> = new Dictionary&lt;string, int&gt;()</td></tr>
<tr class="memdesc:a7e49c12d26657eeb0837340c1f0c5d75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bones lookup table, converts bone names to indices.  <a href="#a7e49c12d26657eeb0837340c1f0c5d75">More...</a><br/></td></tr>
<tr class="separator:a7e49c12d26657eeb0837340c1f0c5d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6656b3441ffa0ecca710f157041cd2a"><td class="memItemLeft" align="right" valign="top">Matrix[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#ae6656b3441ffa0ecca710f157041cd2a">boneTransforms</a></td></tr>
<tr class="memdesc:ae6656b3441ffa0ecca710f157041cd2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This will keep track of all of the bone transforms for a base pose  <a href="#ae6656b3441ffa0ecca710f157041cd2a">More...</a><br/></td></tr>
<tr class="separator:ae6656b3441ffa0ecca710f157041cd2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36b73792412fccbdf5a07b15a226e60d"><td class="memItemLeft" align="right" valign="top">Dictionary&lt; string, <a class="el" href="classApp_1_1Animation_1_1AnimationClip.html">AnimationClip</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a36b73792412fccbdf5a07b15a226e60d">clips</a> = new Dictionary&lt;string, <a class="el" href="classApp_1_1Animation_1_1AnimationClip.html">AnimationClip</a>&gt;()</td></tr>
<tr class="memdesc:a36b73792412fccbdf5a07b15a226e60d"><td class="mdescLeft">&#160;</td><td class="mdescRight">A dictionary so we can keep track of the clips by name  <a href="#a36b73792412fccbdf5a07b15a226e60d">More...</a><br/></td></tr>
<tr class="separator:a36b73792412fccbdf5a07b15a226e60d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf06396ee91756b9ceda4eeddbccc4d"><td class="memItemLeft" align="right" valign="top">const float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#a3bf06396ee91756b9ceda4eeddbccc4d">TinyLength</a> = 1e-8f</td></tr>
<tr class="separator:a3bf06396ee91756b9ceda4eeddbccc4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4220a6e9be9bdb70c3bbb5532a9132b"><td class="memItemLeft" align="right" valign="top">const float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html#af4220a6e9be9bdb70c3bbb5532a9132b">TinyCosAngle</a> = 0.9999999f</td></tr>
<tr class="separator:af4220a6e9be9bdb70c3bbb5532a9132b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class extends the standard ModelProcessor to include code that extracts a skeleton, pulls any animations, and does any necessary prep work to support animation and skinning. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aea72ffe7e084414e5508f84dd5a08adf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AnimationPipeline.AnimationProcessor.FlattenAllTransforms </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recursively flatten all transforms from this node down </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a8132ed58af8d326eb1210fd06de97a4c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">List&lt;NodeContent&gt; AnimationPipeline.AnimationProcessor.FlattenHeirarchy </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>item</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a tree of nodes into a list of nodes in topological order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">item</td><td>The root of the heirarchy</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a class="anchor" id="a41139de03a4f92ccad238418a4219556"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AnimationPipeline.AnimationProcessor.FlattenHeirarchy </td>
          <td>(</td>
          <td class="paramtype">List&lt; NodeContent &gt;&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>item</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3ca18c0cd82c0f3adca2f2bfecf7039c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AnimationPipeline.AnimationProcessor.FlattenTransforms </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BoneContent&#160;</td>
          <td class="paramname"><em>skeleton</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Bakes unwanted transforms into the model geometry, so everything ends up in the same coordinate system. </p>

</div>
</div>
<a class="anchor" id="a43e73c1eddf091312c6bad639d248560"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool AnimationPipeline.AnimationProcessor.IsSkinned </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if a node is a skinned node, meaning it has bone weights associated with it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a class="anchor" id="a542aae0ce95a939066d58a1236af36ec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AnimationPipeline.AnimationProcessor.LinearKeyframeReduction </td>
          <td>(</td>
          <td class="paramtype">LinkedList&lt; <a class="el" href="classApp_1_1Animation_1_1AnimationClip_1_1Keyframe.html">AnimationClip.Keyframe</a> &gt;&#160;</td>
          <td class="paramname"><em>keyframes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function filters out keyframes that can be approximated well with linear interpolation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyframes</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9879bef634fdeef10473d3a6b6026e1e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">override ModelContent AnimationPipeline.AnimationProcessor.Process </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ContentProcessorContext&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The function to process a model from original content into model content for export </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td></td></tr>
    <tr><td class="paramname">context</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<a class="anchor" id="a4ced5d1d24f6961601cf4c955ac10236"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AnimationPipeline.AnimationProcessor.ProcessAnimations </td>
          <td>(</td>
          <td class="paramtype">ModelContent&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ContentProcessorContext&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Entry point for animation processing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td></td></tr>
    <tr><td class="paramname">input</td><td></td></tr>
    <tr><td class="paramname">context</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a723969e331d9421805e95d04418aedc7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AnimationPipeline.AnimationProcessor.ProcessAnimationsRecursive </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recursive function that processes the entire scene graph, collecting up all of the animation data. </p>

</div>
</div>
<a class="anchor" id="a3e94f6b4306da38c809b03182e3a8c2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">BoneContent AnimationPipeline.AnimationProcessor.ProcessSkeleton </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the skeleton in support of skeletal animation... </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1fec0ea7cab5a0295dd94b14e4ade3df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AnimationPipeline.AnimationProcessor.SwapSkinnedMaterial </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If a node is skinned, we need to use the skinned model effect rather than basic effect. This function runs through the geometry and finds the meshes that have bone weights associated and swaps in the skinned effect. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a55100caa7f922c28e5049fd9120ed014"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void AnimationPipeline.AnimationProcessor.TrimSkeleton </td>
          <td>(</td>
          <td class="paramtype">NodeContent&#160;</td>
          <td class="paramname"><em>skeleton</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>3D Studio Max includes an extra help bone at the end of each IK chain that doesn't effect the skinning system and is redundant as far as any game is concerned. This function looks for children who's name ends with "Nub" and removes them from the heirarchy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skeleton</td><td>Root of the skeleton tree</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5ce537df1bc9f23d2b948a423c77d45c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool AnimationPipeline.AnimationProcessor.UselessAnimationTest </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>boneId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Discard any animation not assigned to a mesh or the skeleton </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">boneId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a7e49c12d26657eeb0837340c1f0c5d75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Dictionary&lt;string, int&gt; AnimationPipeline.AnimationProcessor.bones = new Dictionary&lt;string, int&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Bones lookup table, converts bone names to indices. </p>

</div>
</div>
<a class="anchor" id="ae6656b3441ffa0ecca710f157041cd2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Matrix [] AnimationPipeline.AnimationProcessor.boneTransforms</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This will keep track of all of the bone transforms for a base pose </p>

</div>
</div>
<a class="anchor" id="a36b73792412fccbdf5a07b15a226e60d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Dictionary&lt;string, <a class="el" href="classApp_1_1Animation_1_1AnimationClip.html">AnimationClip</a>&gt; AnimationPipeline.AnimationProcessor.clips = new Dictionary&lt;string, <a class="el" href="classApp_1_1Animation_1_1AnimationClip.html">AnimationClip</a>&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A dictionary so we can keep track of the clips by name </p>

</div>
</div>
<a class="anchor" id="ab06ca8642aa12e3b13dbfd1637d27334"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ModelContent AnimationPipeline.AnimationProcessor.model</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The model we are reading </p>

</div>
</div>
<a class="anchor" id="ac7fd1f423cb71f1865f5e7cab97df94a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classApp_1_1Animation_1_1ModelExtra.html">ModelExtra</a> AnimationPipeline.AnimationProcessor.modelExtra = new <a class="el" href="classApp_1_1Animation_1_1ModelExtra.html">ModelExtra</a>()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extra content to associated with the model. This is where we put the stuff that is unique to this project. </p>

</div>
</div>
<a class="anchor" id="af4220a6e9be9bdb70c3bbb5532a9132b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const float AnimationPipeline.AnimationProcessor.TinyCosAngle = 0.9999999f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3bf06396ee91756b9ceda4eeddbccc4d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const float AnimationPipeline.AnimationProcessor.TinyLength = 1e-8f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a43cd4a67fcf9369003f4bf58212a2081"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Dictionary&lt;MaterialContent, SkinnedMaterialContent&gt; AnimationPipeline.AnimationProcessor.toSkinnedMaterial = new Dictionary&lt;MaterialContent, SkinnedMaterialContent&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A lookup dictionary that remembers when we changes a material to skinned material. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>AnimationPipeline/<a class="el" href="AnimationProcessor_8cs.html">AnimationProcessor.cs</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceAnimationPipeline.html">AnimationPipeline</a></li><li class="navelem"><a class="el" href="classAnimationPipeline_1_1AnimationProcessor.html">AnimationProcessor</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
